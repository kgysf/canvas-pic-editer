(function(t){function e(e){for(var o,a,r=e[0],h=e[1],c=e[2],u=0,p=[];u<r.length;u++)a=r[u],s[a]&&p.push(s[a][0]),s[a]=0;for(o in h)Object.prototype.hasOwnProperty.call(h,o)&&(t[o]=h[o]);l&&l(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],o=!0,r=1;r<i.length;r++){var h=i[r];0!==s[h]&&(o=!1)}o&&(n.splice(e--,1),t=a(a.s=i[0]))}return t}var o={},s={app:0},n=[];function a(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=o,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(i,o,function(e){return t[e]}.bind(null,o));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],h=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var l=h;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"28d3":function(t,e,i){"use strict";var o=i("f46c"),s=i.n(o);s.a},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var o=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},n=[],a=(i("5c0b"),i("2877")),r={},h=Object(a["a"])(r,s,n,!1,null,null,null),c=h.exports,l=i("8c4f"),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"home",staticStyle:{height:"100%"}},[t.show?i("pic-editer",{attrs:{wprops:t.wprops}}):i("div",{staticStyle:{height:"100%",width:"100%"}},[t._v("\n    画布宽："),i("input",{directives:[{name:"model",rawName:"v-model",value:t.w,expression:"w"}],domProps:{value:t.w},on:{input:function(e){e.target.composing||(t.w=e.target.value)}}}),t._v("px   画布高："),i("input",{directives:[{name:"model",rawName:"v-model",value:t.h,expression:"h"}],domProps:{value:t.h},on:{input:function(e){e.target.composing||(t.h=e.target.value)}}}),t._v("px   "),i("button",{on:{click:t.create}},[t._v("创建")])])],1)},p=[],f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pic-edit not-screenshots"},[i("div",{staticClass:"pic-edit-panel",staticStyle:{height:"100%"}},[i("div",{staticClass:"pic-edit-panel-tools"},t._l(t.toolList,function(e){return i("span",{key:"tools-"+e.id,class:"pic-edit-panel-tool"+(e.key===t.tool.key?" pic-edit-panel-tool-active":""),attrs:{title:e.name},on:{click:function(i){t.tool=e}}},[i("i",{class:"fa fa-"+e.icon})])}),0),i("div",{staticClass:"pic-edit-panel-history"},[i("div",{staticClass:"pic-edit-panel-tools",staticStyle:{height:"auto"}},[i("span",{staticClass:"pic-edit-panel-tool",attrs:{title:"撤销"},on:{click:t.prev}},[i("i",{staticClass:"fa fa-rotate-left"})]),i("span",{staticClass:"pic-edit-panel-tool",attrs:{title:"重做"},on:{click:t.next}},[i("i",{staticClass:"fa fa-repeat"})]),i("span",{staticClass:"pic-edit-panel-tool",staticStyle:{"background-color":"rgba(226,88,104,0.3)",color:"#FFF"},attrs:{title:"复制编辑后的图片"},on:{click:t.save}},[i("i",{staticClass:"fa fa-save"})])]),i("div",{staticStyle:{flex:"1",overflow:"hidden",padding:"5px 0 10px 0"}},[i("div",{staticStyle:{height:"20px"}},[t._v("历史记录")]),i("div",{ref:"history_list",staticStyle:{height:"calc(100% - 20px)","overflow-y":"auto"}},[t._l(t.historyBefor.stack,function(e,o){return i("div",{key:"history-befor-"+o,staticClass:"history-item"},[t._v(t._s(e.name)+"\n          ")])}),i("div",{staticClass:"history-item history-item-active"},[t._v(t._s(t.history?t.history.name:"无历史记录"))]),t._l(t.afterHistory,function(e,o){return i("div",{key:"history-after-"+o,staticClass:"history-item"},[t._v(t._s(e.name))])})],2)])]),i("div",{staticClass:"pic-edit-panel-option"},[i("div",{staticStyle:{margin:"5px"}},[i("span",{staticClass:"input-title",staticStyle:{width:"100%"}},[t._v("缩放:"+t._s(t.zoom)+"%")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.zoom,expression:"zoom"}],staticStyle:{width:"100%"},attrs:{type:"range",max:"100",min:"1",step:"0.1"},domProps:{value:t.zoom},on:{__r:function(e){t.zoom=e.target.value}}})]),i("div",{staticStyle:{margin:"5px"}},[i("span",{staticClass:"input-title",staticStyle:{width:"100%"}},[t._v("画笔:"+t._s(t.pencil)+"px")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.pencil,expression:"pencil"}],staticStyle:{width:"100%"},attrs:{type:"range",max:"100",min:"1",step:"1"},domProps:{value:t.pencil},on:{__r:function(e){t.pencil=e.target.value}}})]),i("div",{staticStyle:{display:"none"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.color,expression:"color"}],ref:"color_selecter",attrs:{type:"color"},domProps:{value:t.color},on:{input:function(e){e.target.composing||(t.color=e.target.value)}}})]),i("div",{staticStyle:{padding:"5px 5px 0"}},[i("div",{style:t.colorSelecterStyle,on:{click:function(e){return t.$refs.color_selecter.click()}}})]),i("div",{staticStyle:{padding:"5px"}},t._l(t.colorList,function(e){return i("div",{key:e,class:"color-list-item"+(t.color===e?" color-list-item-active":""),style:{backgroundColor:e},on:{click:function(i){t.color=e}}})}),0),i("div",{staticStyle:{padding:"5px"}},[t._m(0),i("div",{staticStyle:{height:"22px"}},[i("input",{directives:[{name:"model",rawName:"v-model.lazy.number",value:t.historyCount,expression:"historyCount",modifiers:{lazy:!0,number:!0}}],staticStyle:{width:"60px","text-align":"center"},attrs:{title:"条",placeholder:"条"},domProps:{value:t.historyCount},on:{change:function(e){t.historyCount=t._n(e.target.value)},blur:function(e){return t.$forceUpdate()}}}),i("span",{staticClass:"input-title"},[t._v("条")])])])])]),i("div",{ref:"pic_edit_canvas",staticClass:"pic-edit-container",staticStyle:{height:"100%"}},[i("div",{ref:"pic_canvas_container",staticClass:"pic-edit-canvas",style:t.picEditCanvasStyle,on:{click:t.mouseclick,mousedown:t.mousedown,mouseup:t.mouseup,mousemove:t.mousemove,mousewheel:t.mousewheel}},[i("canvas",{ref:"pic_canvas",style:t.canvasStyle,attrs:{id:"pic_canvas",width:t.wprops.detail.width,height:t.wprops.detail.height},on:{mousedown:t.mousedownFromCanvas,mouseup:t.mouseupFromCanvas,mousemove:t.mousemoveFromCanvas}}),i("div")])])])},d=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"22px"}},[i("span",{staticClass:"input-title"},[t._v("保留历史记录")])])}],m=(i("a481"),i("75fc")),v=i("d225"),y=i("b0b4"),w=function(){function t(){Object(v["a"])(this,t),this.reverse=!1;for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];this.stack=[].concat(i)}return Object(y["a"])(t,[{key:"push",value:function(){var t,e;return this.reverse?(t=this.stack).unshift.apply(t,arguments):(e=this.stack).push.apply(e,arguments)}},{key:"pop",value:function(){return this.reverse?this.stack.shift():this.stack.pop()}}]),t}(),g=[{id:0,key:"move",name:"移动画布",icon:"hand-paper-o",mouse:"grab"},{id:1,key:"minus",name:"缩小画布",icon:"search-minus",mouse:"zoom-out"},{id:2,key:"plus",name:"放大画布",icon:"search-plus",mouse:"zoom-in"},{id:3,key:"hLine",name:"横直线",icon:"arrows-h",mouse:"crosshair"},{id:4,key:"vLine",name:"竖直线",icon:"arrows-v",mouse:"crosshair"},{id:5,key:"line",name:"直线",icon:"minus",mouse:"crosshair"},{id:6,key:"pen",name:"画笔",icon:"pencil",mouse:"crosshair"},{id:7,key:"rect",name:"矩形",icon:"square-o",mouse:"crosshair"},{id:8,key:"circle",name:"圆",icon:"circle-o",mouse:"crosshair"}],x=function t(e,i){Object(v["a"])(this,t),this.dataUrl=e,this.name=i},k={name:"pic-editer",props:["wprops"],computed:{canvasStyle:function(){var t=this,e=this.zoom/100*this.wprops.detail.height,i=this.zoom/100*this.wprops.detail.width;this.$nextTick(function(){t.move(t.info.move.x,t.info.move.y)});var o={height:e+"px",width:i+"px"};return this.transition&&(o.transition=this.transition),o},colorSelecterStyle:function(){return{backgroundColor:this.color,height:"24px",transition:"all 400ms"}},picEditCanvasStyle:function(){return{width:"100%",height:"100%",cursor:this.tool.mouse}},afterHistory:function(){return Object(m["a"])(this.historyAfter.stack).reverse()}},data:function(){return{historyCount:50,historyBefor:new w,historyAfter:new w,history:null,toolList:g,colorList:["#000000","#FFFFFF","#33B1FF","#00EFFF","#FF4C00","#FF0005","#FFD800","#39BB00"],color:"#000000",zoom:1,pencil:1,tool:g[0],width:"100%",height:"100%",point:null,pointFromCanvas:null,info:{move:{x:50,y:50},tool:null,keyDown:!1},transition:null,timeout:{zoom:null}}},mounted:function(){var t=this;this.resize(),this.loadPic(this.wprops.src,function(){t.setHistory("打开图片")}),this.suitable(),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)},destroyed:function(){window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup),this.history=null,this.historyAfter=null,this.historyBefor=null,this.tool=null,this.info=null},methods:{save:function(){alert("请在画布上右键复制图片")},keydown:function(t){switch(t.code){case"Space":this.info.keyDown||(this.info.keyDown=!0,this.$set(this.info,"tool",this.tool),this.$set(this,"tool",g[0]));break;case"Minus":t.ctrlKey&&this.zooma(1*this.zoom-10);break;case"Equal":t.ctrlKey&&this.zooma(1*this.zoom+10);break}if(t.ctrlKey&&/Numpad[0-9]/gi.test(t.code)){var e=1*t.key-1;this.$set(this,"tool",g[e])}t.ctrlKey&&!t.shiftKey&&"KeyZ"===t.code&&this.prev(),t.ctrlKey&&t.shiftKey&&"KeyZ"===t.code&&this.next()},keyup:function(t){switch(t.code){case"Space":this.info.keyDown&&(this.$set(this,"tool",this.info.tool),this.$set(this.info,"tool",null),this.info.keyDown=!1);break}},getDataUrl:function(){var t=this.$refs.pic_canvas;return t.toDataURL()},getImageData:function(){var t=this.$refs.pic_canvas,e=t.getContext("2d");return e.getImageData(0,0,e.canvas.width,e.canvas.height)},setHistory:function(t){this.history=new x(this.getImageData(),t)},newHistory:function(t){this.historyBefor.push(this.history);while(this.historyBefor.stack.length>this.historyCount)this.historyBefor.reverse=!0,this.historyBefor.pop(),this.historyBefor.reverse=!1;this.historyAfter=new w,this.history=new x(this.getImageData(),t),this.historyListScroll()},prevHistory:function(){var t=this.historyBefor.pop();if(t){this.historyAfter.push(this.history);while(this.historyAfter.stack.length>this.historyCount)this.historyAfter.reverse=!0,this.historyAfter.pop(),this.historyAfter.reverse=!1;this.history=t}return this.history},nextHistory:function(){var t=this.historyAfter.pop();if(t){this.historyBefor.push(this.history);while(this.historyBefor.stack.length>this.historyCount)this.historyBefor.reverse=!0,this.historyBefor.pop(),this.historyBefor.reverse=!1;this.history=t}return this.history},next:function(){var t=this.nextHistory();this.putImage(t.dataUrl)},prev:function(){var t=this.prevHistory();this.putImage(t.dataUrl)},historyListScroll:function(){var t=this;this.$nextTick(function(){var e=t.$refs.history_list;e&&(e.scrollTop=e.scrollHeight)})},resize:function(){var t=this.$refs.pic_canvas_container;this.width=window.getComputedStyle(t)["width"],this.height=window.getComputedStyle(t)["height"]},mouseclick:function(t){switch(this.tool.key){case"plus":this.zooma(1*this.zoom+10);break;case"minus":this.zooma(1*this.zoom-10);break}},mousedown:function(t){this.point={},this.point.x=t.offsetX,this.point.y=t.offsetY},mouseup:function(t){this.point=null},mousemove:function(t){if(this.point){var e={x:t.movementX,y:t.movementY},i=1*this.width.replace(/px/gi,""),o=1*this.height.replace(/px/gi,"");switch(this.point.x=t.offsetX,this.point.y=t.offsetY,this.tool.key){case"move":var s=this.info.move.x+e.x/i*100,n=this.info.move.y+e.y/o*100;this.move(s,n);break}}},mousedownFromCanvas:function(t){this.pointFromCanvas={},this.pointFromCanvas.x=t.offsetX,this.pointFromCanvas.y=t.offsetY;var e=this.zoom/100,i={x:this.pointFromCanvas.x/e,y:this.pointFromCanvas.y/e};switch(this.tool.key){case"pen":this.startDrawPath(i);break}},mouseupFromCanvas:function(t){switch(this.tool.key){case"hLine":this.putImage(this.history.dataUrl,0,0),this.hLine(this.pointFromCanvas,t.offsetX),this.newHistory("绘制横直线");break;case"vLine":this.putImage(this.history.dataUrl,0,0),this.vLine(this.pointFromCanvas,t.offsetY),this.newHistory("绘制竖直线");break;case"line":this.putImage(this.history.dataUrl,0,0),this.line(this.pointFromCanvas,{x:t.offsetX,y:t.offsetY}),this.newHistory("绘制直线");break;case"pen":this.endDrawPath(),this.newHistory("自由绘制");break;case"rect":this.putImage(this.history.dataUrl,0,0),this.rect(this.pointFromCanvas,{x:t.offsetX,y:t.offsetY}),this.newHistory("绘制矩形");break;case"circle":this.putImage(this.history.dataUrl,0,0),this.ellipse(this.pointFromCanvas,{x:t.offsetX,y:t.offsetY}),this.newHistory("绘制圆形");break}this.endDrawPath(),this.pointFromCanvas=null},mousemoveFromCanvas:function(t){if(this.pointFromCanvas)switch(this.tool.key){case"hLine":this.putImage(this.history.dataUrl,0,0),this.hLine(this.pointFromCanvas,t.offsetX);break;case"vLine":this.putImage(this.history.dataUrl,0,0),this.vLine(this.pointFromCanvas,t.offsetY);break;case"line":this.putImage(this.history.dataUrl,0,0),this.line(this.pointFromCanvas,{x:t.offsetX,y:t.offsetY});break;case"pen":this.pen({x:t.offsetX,y:t.offsetY});break;case"rect":this.putImage(this.history.dataUrl,0,0),this.rect(this.pointFromCanvas,{x:t.offsetX,y:t.offsetY});break;case"circle":this.putImage(this.history.dataUrl,0,0),this.ellipse(this.pointFromCanvas,{x:t.offsetX,y:t.offsetY});break}},mousewheel:function(t){var e=t.wheelDelta,i=1*this.zoom+(e>0?2:-2);this.zooma(i)},loadPic:function(t,e){var i=this.$refs.pic_canvas,o=i.getContext("2d"),s=new Image;s.onload=function(){i.width=s.width,i.height=s.height,o.drawImage(s,0,0),e()},s.src=t},suitable:function(){var t=this.wprops.detail.height,e=this.wprops.detail.width;this.zoom=t>e?Math.floor((1*this.height.replace(/px/gi,"")-400)/t*100):Math.floor((1*this.width.replace(/px/gi,"")-400)/e*100),this.move(50,50)},zooma:function(t){var e=this;this.transition="all 200ms",this.zoom=t>100?100:t<1?1:t.toFixed(2),this.timeout.zoom&&clearTimeout(this.timeout.zoom),this.timeout.zoom=setTimeout(function(){e.transition=null,clearTimeout(e.timeout.zoom),e.timeout.zoom=null},200)},move:function(t,e){var i=document.querySelector("#pic_canvas"),o={height:this.zoom/100*this.wprops.detail.height,width:this.zoom/100*this.wprops.detail.width},s=1*this.width.replace(/px/gi,""),n=1*this.height.replace(/px/gi,"");i&&(i.style.margin="".concat(n*(e/100)-.5*o.height,"px 0px 0px ").concat(s*(t/100)-.5*o.width,"px")),this.info.move={x:t,y:e}},line:function(t,e){var i=this.zoom/100,o={x:t.x/i,y:t.y/i},s={x:e.x/i,y:e.y/i};this.drawLine(o,s)},hLine:function(t,e){var i=this.zoom/100,o={x:t.x/i,y:t.y/i},s={x:e/i,y:t.y/i};this.drawLine(o,s)},vLine:function(t,e){var i=this.zoom/100,o={x:t.x/i,y:t.y/i},s={x:t.x/i,y:e/i};this.drawLine(o,s)},pen:function(t){var e=this.zoom/100,i={x:t.x/e,y:t.y/e};console.log("PEN",i),this.drawPath(i)},rect:function(t,e){var i=this.zoom/100,o=t.x/i,s=t.y/i,n=(e.x-t.x)/i,a=(e.y-t.y)/i;this.drawRect(o,s,n,a)},ellipse:function(t,e){var i=this.zoom/100,o=(t.x>e.x?e.x:t.x)/i,s=(t.y>e.y?e.y:t.y)/i,n=(e.x>t.x?e.x-t.x:t.x-e.x)/i,a=(e.y>t.y?e.y-t.y:t.y-e.y)/i;this.drawEllipse(o,s,n,a)},putImage:function(t,e,i){var o=this.$refs.pic_canvas,s=o.getContext("2d");s.putImageData(t,e,i)},drawLine:function(t,e){var i=this.$refs.pic_canvas,o=i.getContext("2d");o.beginPath(),o.strokeStyle=this.color,o.lineWidth=this.pencil,o.moveTo(t.x,t.y),o.lineTo(e.x,e.y),o.stroke(),o.closePath()},startDrawPath:function(t){var e=this.$refs.pic_canvas,i=e.getContext("2d");i.beginPath(),i.strokeStyle=this.color,i.lineWidth=this.pencil,i.moveTo(t.x,t.y)},endDrawPath:function(){var t=this.$refs.pic_canvas,e=t.getContext("2d");e.closePath()},drawPath:function(t){var e=this.$refs.pic_canvas,i=e.getContext("2d");i.lineTo(t.x,t.y),i.stroke()},drawRect:function(t,e,i,o){var s=this.$refs.pic_canvas,n=s.getContext("2d");n.strokeStyle=this.color,n.lineWidth=this.pencil,n.strokeRect(t,e,i,o)},drawEllipse:function(t,e,i,o){var s=this.$refs.pic_canvas,n=s.getContext("2d");n.strokeStyle=this.color,n.lineWidth=this.pencil;var a=i>o?o:i,r=i/a,h=o/a;n.save(),n.scale(r,h),n.beginPath(),n.arc((t+.5*i)/r,(e+.5*o)/h,.5*a,0,2*Math.PI,!1),n.closePath(),n.restore(),n.stroke()}}},C=k,b=(i("28d3"),Object(a["a"])(C,f,d,!1,null,"60ac8874",null)),_=b.exports,S={name:"home",components:{PicEditer:_},data:function(){return{show:!1,wprops:{detail:{height:0,width:0},src:null},h:768,w:1280}},methods:{create:function(){var t=document.createElement("canvas");t.width=this.w,t.height=this.h;var e=t.getContext("2d");e.fillStyle="#FFF",e.fillRect(0,0,this.w,this.h);for(var i=0;i<this.h;i+=5)console.log(i,i%10?i%50?5:15:8),e.beginPath(),e.strokeStyle="#000",e.lineWidth=1,e.moveTo(0,i),e.lineTo(i%10?5:i%50?8:15,i),e.stroke(),e.closePath();for(var o=0;o<this.w;o+=5)console.log(o,o%10?o%50?5:15:8),e.beginPath(),e.strokeStyle="#000",e.lineWidth=1,e.moveTo(o,0),e.lineTo(o,o%10?5:o%50?8:15),e.stroke(),e.closePath();var s=t.toDataURL();this.wprops.src=s,this.wprops.detail.height=this.h,this.wprops.detail.width=this.w,this.show=!0}}},F=S,z=Object(a["a"])(F,u,p,!1,null,null,null),P=z.exports;o["a"].use(l["a"]);var L=new l["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:P}]});i("1f54");o["a"].config.productionTip=!1,new o["a"]({router:L,render:function(t){return t(c)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var o=i("5e27"),s=i.n(o);s.a},"5e27":function(t,e,i){},f46c:function(t,e,i){}});
//# sourceMappingURL=app.8237ef14.js.map